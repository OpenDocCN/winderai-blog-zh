# 通过强化学习实现网络安全自动化

> 原文：<https://winder.ai/automating-cyber-security-with-reinforcement-learning/>

提高任何系统安全性的最佳方法是检测所有漏洞并修补它们。不幸的是，由于现代系统的极端复杂性，这几乎是不可能的。

常见的建议是测试安全性，通常利用专注于安全性的工程师或自动化脚本的专业知识。但是这种方法有两个基本问题:1)安全工程师无法扩展，2)脚本不可能一开始就涵盖所有的安全问题，更不用说处理新的威胁或增加的攻击面了。

强化学习(RL)是机器学习的一个子集，它通过试错来优化问题以完善策略。一个 RL 代理，一个 RL 模型的具体体现，可以像人类一样被教导使用策略来实现目标。

例如，我们可以训练一个 RL 代理来执行渗透测试或“入侵”一个 API。组织可以利用这种技术主动和被动地测试他们的应用程序是否安全(或者至少与代理的功能一样安全)。

在这篇文章中，我介绍了网络安全中受益于 RL 的三个关键领域，我和我的团队能够以点解决方案的形式提供这些领域。

 [我关于强化学习的新书](https://rl-book.com/?utm_source=winderresearch&utm_medium=web&utm_campaign=rl) 

你想在现实生活、商业应用中使用 RL 吗？你想知道真相吗？最佳实践？

我们为 O'Reilly 写了一本关于强化学习的书。它侧重于工业 RL，有许多真实生活的例子和深入的分析。

了解更多关于 https://rl-book.com 的信息。

## Web 应用防火墙

一个重要的威胁来自公共互联网的有效载荷，攻击者通过改变请求来发现和利用漏洞。

Web 应用程序防火墙(WAF)，或者说，针对特定应用程序的精选防火墙，用于检测和阻止可疑行为。这些通常是基于规则的，当它们检测到恶意活动时，它们会减轻潜在的损害。

然而，WAF 的有效性完全取决于检测有效载荷是否有害的能力。

定义“有害”是一个不断变化的目标，因为攻击者不断试图找到逃避检测的新模式。

WAFs 及其保护的应用程序特别容易受到攻击，因为像 SQL 这样的高表达性语言非常复杂。

这个问题一个解决方案是建立一个能够主动攻击晶片直到它变得可利用的自主代理。这种代理可以生成恶意的有效载荷，并了解当前 WAF 配置的弱点。

像 [ModSecurity](https://www.modsecurity.org) 这样的开源 WAF 实现提供了一个行业标准的试验场，可以将[整合到模拟](https://arxiv.org/abs/2001.01952)中；后常被称为健身房， [OpenAI 的](https://openai.com) [健身房界面](http://arxiv.org/abs/1606.01540)。

通过一个方便的模拟，RL 代理能够自动开发有效的策略来规避 WAF 策略，并很可能影响正在运行的系统。代理也可以用类似的方法定位应用程序代码。

然后，操作员和开发人员将评估代理的结果并实施更改，以减少或消除部署的配置和应用程序中的差距。

## 预妥协和渗透测试

现代 IT 基础设施和应用程序是由领域专家设计、实现和维护的；不是安全专家。由于外部攻击的数量和规模不断增加，保护这些资产已成为一项全职工作。现代软件开发的快节奏意味着对这些工程师的需求很大，而且往往是一个瓶颈。

一种解决方案是尝试自动化安全流程和测试。尤其是渗透测试，自动化的时机已经成熟，因为寻找漏洞的过程是劳动和技能密集型的。

当然，目标取决于具体的应用程序实现，因此大多数当前的研究都集中于在[抽象环境](https://arxiv.org/abs/2009.08120)中学习最佳攻击模式，而不是工业工具。

一个更容易处理的解决方案可能是训练一个代理来[安排和指导安全专家](https://dl.acm.org/doi/abs/10.1145/2882969)应对重大风险；换句话说，把它变成一个优先排序问题。

但是给定时间和工程努力，将自动化渗透测试应用于特定的问题是非常可行的。

例如，您可以轻松地对 web 内容中的动作和后续移动进行建模，这意味着您还可以自动化对动态 web 内容的[尝试渗透。](https://arxiv.org/abs/2009.11274)

一个示例结果可能是代理了解到可能会访问某个废弃的测试页面，然后向`wp-login/index.php`发送请求，这将导致管理员访问。

## 对抗性攻击-攻击攻击者

传统上，对抗性训练被用来欺骗另一个系统，使其相信机器学习算法与人类执行某些任务一样好，如果不是更好的话，比如绘画或回答问题。但是在安全的背景下，对立的观点特别有吸引力。

想象一个软件定义的网络，就像大多数 Kubernetes 实现中使用的网络一样。应用程序使用的网络不直接耦合到物理交换机和跳线。它们完全由软件定义；在一场竞赛中。

软件定义网络提供了灵活性、动态性和封装性的多重优势。例如，如果攻击者有权限，他们可以利用相同的机制将流量重定向到外部公共服务器或窃听所有通信。

一个内部的、友好的、基于 RL 的代理同样能够在虚拟监狱中使用相同的技术来阻止和诱捕网络上的攻击者。

我知道这听起来像创。但是这是完全可行的，并且最近已经在一个简化的环境中得到验证。

这个想法也适用于任何其他类型的攻击。

例如，我可以想象一个 WAF 检测到一个攻击并动态创建一个 SQL 蜜罐，甚至是一个反向僵尸网络，对攻击僵尸程序执行 DoS 攻击。

然而，这引发了一场智力上有趣但可怕的 RL 驱动的军备竞赛，攻击和反击创造了一个虚拟的反乌托邦。

## 立即行动

事实上，我认为一个集成的叙事，一个拥有多个同类最佳的安全工具，通过开放 API 进行交互的叙事，才是未来。然后，代理可以在防火墙级别或通过更改 WAF 规则轻松阻止攻击，从而在源头上防止攻击。

此外，如果适用，代理可以将信息反馈给下游应用程序和 CI/CD 管道以及上游开源项目，以确保漏洞得到快速检查和修补。

处于 RL 驱动的网络安全的最前沿也是一种竞争优势。与成功的黑客攻击相关的成本相比，在自动发现安全漏洞和开发主动对策方面的投资就相形见绌了。

我和我的同事在温德。AI 在这里帮助你找到最佳的数据驱动的解决方案来解决你的问题，RL 可能是(也可能不是)不可或缺的一部分。[如果您想了解 RL 如何帮助您的业务](https://winder.ai/about/contact/)，或者我们很乐意讨论您遇到的任何与数据相关的问题，请联系我们。

如果你有兴趣了解更多关于 RL 的知识，你可以在我们的书中找到丰富的信息。

## 进一步阅读

下面是我在研究本文时使用的一些链接，您可能会发现这些链接很有用:

*   常规 RL
    *   [我们关于 RL 基础和工业应用的书](https://rl-book.com)
*   妥协前/渗透测试
    *   [用于自动测试的无模型 RL](https://arxiv.org/abs/1905.05965)
    *   [通过自助游戏实现自动化安全策略](https://arxiv.org/abs/2009.08120)
    *   [测试和分析师的优化调度](https://dl.acm.org/doi/abs/10.1145/2882969)
    *   [简化网络输入](https://www.ai.rug.nl/~mwiering/GROUP/ARTICLES/CyberSec_ICAART.pdf)
    *   [模拟和简单 RL](https://thesiscommons.org/nxzep)
    *   [单宿主测试](https://ieeexplore.ieee.org/abstract/document/9139683)
    *   [RL 黑客建模和框架](https://arxiv.org/abs/2009.11274)
*   Web 应用防火墙
    *   [晶圆健身房 1](https://openreview.net/forum?id=m5AntlhJ7Z5)
    *   [晶圆健身房 2](https://arxiv.org/abs/2001.01952)
    *   [SQL 注入](https://arxiv.org/abs/2101.03118)
*   妥协后/对手模拟
    *   [自动模拟物联网连接系统中的对手](https://arxiv.org/abs/2011.04635)
*   不知道
    *   [防御性备份策略](https://arxiv.org/abs/2102.06632)
*   智能能源攻击缓解
    *   [发电系统脆弱性评分](https://arxiv.org/abs/2007.03025)
    *   [智能电网网络攻击检测](https://arxiv.org/abs/1809.05258)
    *   [智能电网网络攻击缓解](https://arxiv.org/abs/2009.13088)
*   对抗性攻击缓解
    *   [在自动驾驶汽车中](https://arxiv.org/abs/1805.00983)
    *   [在软件定义的网络中](https://arxiv.org/abs/1808.05770)
*   白帽黑客
    *   [利用 RL 规避静态恶意软件模型(或一般模型)](https://arxiv.org/abs/1801.08917)
    *   [心脏出血缓解](https://dl.acm.org/doi/abs/10.1145/2663474.2663481)
*   调查
    *   [通用](https://arxiv.org/abs/1906.05799)
    *   [常规-所有 ML](https://link.springer.com/article/10.1631%2FFITEE.1800573)
    *   [物联网安全](https://arxiv.org/abs/2102.07247)
    *   [通信和网络](https://arxiv.org/abs/1810.07862)
*   技术
    *   [在网络安全应用中使用非合作逆向强化学习](https://arxiv.org/abs/1911.04220)
    *   [多代理设计/关键基础设施](https://ieeexplore.ieee.org/abstract/document/8442695)