# 新冠肺炎的回应:雅典娜工程和贝叶斯分析介绍

> 原文：<https://winder.ai/covid-19-response-athena-project-and-an-introduction-bayesian-analysis/>

在接下来的几周里，我将使用贝叶斯分析来模拟新冠肺炎的传播。受启动[雅典娜项目](https://athena-project.life/)的 Alex Stage 的启发，我承诺 [Winder。AI](https://winder.ai/) 来帮助雅典娜达到它的目标。

[https://www.youtube.com/embed/kGoyK4wZYas](https://www.youtube.com/embed/kGoyK4wZYas)

我将帮助的第一个项目是开发和部署简单的流行病模型，以便用户不仅能够查看当前的数据，还可以查看对未来数据的估计。为了实现这一点，我想使用贝叶斯模型，捕捉数据中固有的不确定性。

这篇文章是执行贝叶斯分析时的一组快速最佳实践；后续文章将介绍我的工作。我会用新的信息更新这篇文章。

新冠肺炎研究

以下是本系列中其他新冠肺炎文章的链接列表。

*   [新冠肺炎指数贝叶斯模型](https://winder.ai/covid-19-exponential-bayesian-model/)
*   [新冠肺炎指数贝叶斯模型回测](https://winder.ai/covid-19-exponential-bayesian-model-backtesting/)
*   [新冠肺炎逻辑斯谛贝叶斯模型](https://winder.ai/covid-19-logistic-bayesian-model/)
*   [新冠肺炎分层贝叶斯逻辑模型与 pymc3](https://winder.ai/covid-19-hierarchical-bayesian-logistic-model-with-pymc3/)
*   [用于部署机器学习模型的简单的基于 Docker 的工作流](https://winder.ai/a-simple-docker-based-workflow-for-deploying-a-machine-learning-model/)

## 贝叶斯数据分析

贝叶斯线性回归还是线性回归。但是*贝叶斯*部分帮助我们传播概率估计，以提供对结果更直观的解释。事实上，这与非数据科学家对概率的看法类似。关键是根据可能性的分布，而不是固定点，来考虑你的数据，你的模型，你的工作。你必须适应缺乏精确性；灰色阴影。关于贝叶斯思维的详细介绍，请查看最后的 T2 阅读材料。

### 马尔可夫链蒙特卡罗

[马尔可夫链](https://en.wikipedia.org/wiki/Markov_chain)是由选择构成的链接。它们根据转移概率描述从一个状态到下一个状态的运动。[蒙特卡洛](https://en.wikipedia.org/wiki/Monte_Carlo_method)是一种黑盒抽样技术，通过这种技术，你反复要求一个未知系统产生一个响应。这些在[马尔可夫链蒙特卡罗](https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo) (MCMC)算法中一起使用，从一个无法解析求解的分布中构建样本链。这个链“行走”(我喜欢把它看作“绊倒”)到生成观察结果，看起来完全像你想要模拟的分布，在这一点上，你可以从链中取样，以生成概率分布的汇总统计或绘图。

## 模型的性能

轨迹图显示了单链过程中参数的估计值。您可以多次生成此链。如果你的模型是有代表性的，那么链应该在同一个地方结束。即每个链应该预测相同的参数。如果是这样，那么你会对结果更有信心。如果不是，那么你不能相信这些估计。换句话说，它们应该是静止的，并且在重复时会聚到同一位置。从视觉上看，你想要通常被描述为看起来像“毛毛虫”或“草”的链条。链的概率分布应该是相似的。

虽然我总是建议使用可视化的性能解释，但是您也可以使用常见的汇总统计数据:

*   **平均值的标准误差**:这是仅具有有限数量的后验抽取所带来的不确定性的数量。蒙特卡罗中的抽样误差。比如标准误差。
*   **有效样本量**:这是链中的自相关量，相对于样本量来说，这个值应该很高。如果它很低，那就意味着这个链在随机地到处走，随机地抽样。你不想这样；您希望链专注于正确的结果。
*   **潜在规模缩减系数**:这衡量链条“混合”的程度。它是基于链间估计参数的方差和链内方差的收敛估计。它被解释为随着链变长，估计值的方差可能减少的因子。我们正在寻找一个接近 1 的值。

### 后验分布检验

您可以随时获取模型的参数，并根据这些参数生成新数据。这将生成一组全新的数据，这些数据应该与原始数据相匹配。

类似地，您可以绘制一个相对于另一个的图，就像在原始数据上绘制最佳拟合线一样。您可以多次重新生成该数据，以查看真实数据的变化。

后验绘图的自相关仅在第一滞后时相关。较高滞后的相关性(高序列相关性)意味着模型没有收敛。更大的链条可能会有所帮助。`n_eff`试图表现这一特征。

### 敏感性分析

这些检查是为了查看对模型设置的更改(即使是微小的更改)是否会改变结果。例如，不同的超参数、不同但似是而非的先验、不同的抽样分布或解释变量的添加和删除。

### 预测准确性/模型比较

使用赤池信息标准(AIC)或偏差信息标准(DIC)。

## 先验的选择

非信息先验优先考虑数据。通常我们使用弱信息先验。问题的经验法则或约束。基于先前研究的信息先验。

尽可能使用共轭分布。在回归模型中，共轭设置对预测系数使用正态分布，对方差使用逆伽玛。例如，高斯族相对于高斯似然函数与其自身共轭(或自共轭):如果似然函数是高斯的，选择高斯先验而不是均值将确保后验分布也是高斯的。[更多信息和缀合物列表](https://en.wikipedia.org/wiki/Conjugate_prior)。

Stan 收集了大量关于之前推荐的信息。

## 进一步阅读

*   艾伦·唐尼的《思考贝叶斯》
*   【PyMC3 使用简介
*   [好短，R 贝叶斯建模简介](https://m-clark.github.io/bayesian-basics/intro.html)
*   [贝叶斯数据分析-非商业用途的免费 PDF](http://www.stat.columbia.edu/~gelman/book/)